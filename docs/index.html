<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Import, clean and update data from the New Zealand Freshwater Fish Database • nzffdr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Import, clean and update data from the New Zealand Freshwater Fish Database">
<meta property="og:description" content="Access the New Zealand Freshwater Fish Database (url) from r and a few functions to clean the data once in R.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">nzffdr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="nzffdr-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#nzffdr-" class="anchor"></a>nzffdr <img src="reference/figures/nzffdr_hex.png" align="right" height="150">
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>The purpose of this package is to allow for direct access to the NZ Freshwater Fish Database (<a href="https://nzffdms.niwa.co.nz/search">NZFFD</a>) from R and additional functions for cleaning imported data and adding missing data.</p>
<div id="installation" class="section level3">
<h3 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># devtools::install_github("flee598/nzffdr")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">nzffdr</span><span class="op">)</span></code></pre></div>
</div>
<div id="built-in-datasets" class="section level3">
<h3 class="hasAnchor">
<a href="#built-in-datasets" class="anchor"></a>Built-in datasets</h3>
<p>There are four built-in datasets to assist, these are:</p>
<ul>
<li><p><code>nzffd_data</code> a subset of 200 rows from the NZFFD, used for examples, tutorials etc.</p></li>
<li><p><code>nzffd_method</code> a dataframe containing all the different fishing methods included in the NZFFD, it is possible to search the database using these terms so they are provided for reference.</p></li>
<li><p><code>nzffd_species</code> a dataframe of the scientific and common names of all species included in the NZFFD. It is possible to search the database by species name (using scientific or common names) so these are provided for reference.</p></li>
<li><p><code>nzffd_nzmap</code> a simple features map of New Zealand. A simplified version of the 1:150k NZ map outline available from <a href="https://www.linz.govt.nz">Land Information New Zealand</a>.</p></li>
</ul>
</div>
<div id="getting-data" class="section level3">
<h3 class="hasAnchor">
<a href="#getting-data" class="anchor"></a>Getting data</h3>
<p>Start by importing some data. We have tried to make the search terms match those you would use directly on the Niwa site. For example leaving a search field blank will return all records. There are seven search arguments:</p>
<ul>
<li><p><code>catchment</code> this refers to the Catchment No. a 6 digit number unique to the reach of interest. You can search using the inidviual number (e.g. <code>catchment = "702.500"</code>), or for all rivers in a catchment you can use the wildcard search term (e.g. <code>catchment = "702%"</code>), or don’t set the arg if you want all catchments in NZ.</p></li>
<li><p><code>river</code> search for a river by name, to get all records for the Clutha (e.g. <code>river = "Clutha"</code>).</p></li>
<li><p><code>location</code> search for river by location e.g. (<code>location = "Nelson"</code>).</p></li>
<li><p><code>fish_method</code> search by fishing method used. There are 59 different possible options for <code>fish_method</code>, if you want to search for a specific fishing method use <code><a href="reference/nzffd_method.html">nzffd_method()</a></code> to see a list of all possible options, you can then copy/paste from there (e.g. if we only wanted fish caught by lures use <code>fish_meth = "Angling - Lure"</code>) don’t set the arg if you want all fishing methods.</p></li>
<li><p><code>species</code> search for a particular species. There are 75 different possible options for <code>species</code>, use <code><a href="reference/nzffd_species.html">nzffd_species()</a></code> to see a list of all possible options. You can search using either common or scientific names and can search for multiple species at once. e.g. to search for Black mudfish use <code>species = "Black mudfish"</code> or <code>species = "Neochanna diversus"</code> and to search for Black mudfish and Bluegill bully use <code>species = c("Black mudfish", "Bluegill bully")</code> etc.</p></li>
<li><p><code>starts</code> starting search date, 1850 at the earliest.</p></li>
<li><p><code>ends</code> ending search date.</p></li>
</ul>
<p>This function requires an internet connection to query Niwa’s database.</p>
<p>Data citation: Crow S (2017). New Zealand Freshwater Fish Database. Version 1.2. The National Institute of Water and Atmospheric Research (NIWA). Occurrence Dataset <a href="https://doi.org/10.15468/ms5iqu" class="uri">https://doi.org/10.15468/ms5iqu</a></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># import all records between 2000 and 2010</span>
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/nzffd_import.html">nzffd_import</a></span><span class="op">(</span>catchment <span class="op">=</span> <span class="st">""</span>, river <span class="op">=</span> <span class="st">""</span>, location <span class="op">=</span> <span class="st">""</span>, 
  fish_method <span class="op">=</span> <span class="st">""</span>, species <span class="op">=</span> <span class="st">""</span>, starts <span class="op">=</span> <span class="fl">2000</span>, ends <span class="op">=</span> <span class="fl">2010</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>
<span class="co">#&gt;   card m    y catchname   catch                locality time org map    east</span>
<span class="co">#&gt; 1  294 5 2000    Long B 075.000 Unnamed stream Long Bay      arc r10 2664600</span>
<span class="co">#&gt; 2  294 5 2000    Long B 075.000 Unnamed stream Long Bay      arc r10 2664600</span>
<span class="co">#&gt; 3  294 5 2000    Long B 075.000 Unnamed stream Long Bay      arc r10 2664600</span>
<span class="co">#&gt; 4  295 5 2000    Long B 075.000 Unnamed stream Long Bay      arc r10 2664600</span>
<span class="co">#&gt; 5  295 5 2000    Long B 075.000 Unnamed stream Long Bay      arc r10 2664600</span>
<span class="co">#&gt; 6  295 5 2000    Long B 075.000 Unnamed stream Long Bay      arc r10 2664600</span>
<span class="co">#&gt;     north altitude penet fishmeth effort pass spcode abund number minl maxl</span>
<span class="co">#&gt; 1 6499800       30     3      gmt      6   NA galfas            2   95  110</span>
<span class="co">#&gt; 2 6499800       30     3      gmt      6   NA gobhut            2   80   85</span>
<span class="co">#&gt; 3 6499800       30     3      gmt      6   NA parane            1   40   NA</span>
<span class="co">#&gt; 4 6499800       30     3      fyn      3   NA gobgob            1  150   NA</span>
<span class="co">#&gt; 5 6499800       30     3      fyn      3   NA galfas            3  130  135</span>
<span class="co">#&gt; 6 6499800       30     3      fyn      3   NA parane            2   70   75</span>
<span class="co">#&gt;   nzreach</span>
<span class="co">#&gt; 1 2004154</span>
<span class="co">#&gt; 2 2004154</span>
<span class="co">#&gt; 3 2004154</span>
<span class="co">#&gt; 4 2004154</span>
<span class="co">#&gt; 5 2004154</span>
<span class="co">#&gt; 6 2004154</span>

<span class="co"># To import the entire NZFF database:</span>
<span class="co"># dat &lt;- nzffd_import()</span></code></pre></div>
</div>
<div id="cleaning-data" class="section level3">
<h3 class="hasAnchor">
<a href="#cleaning-data" class="anchor"></a>Cleaning data</h3>
<p>While the data imported from NZFFD is in pretty good shape there are some small inconsistencies. The <code><a href="reference/nzffd_clean.html">nzffd_clean()</a></code> function aims to deal with some of these inconsistencies. In particular text strings have been standardised. The first letter of all words in <code>catchname</code> and <code>locality</code> are capitalised and any non-alphanumeric characters are removed. <code>time</code> is converted to a standardised 24 hour format and nonsesical values converted to <code>NA</code>. <code>org</code> is converted to all lowercase and has non-alphanumeric characters removed. <code>map</code> is converted to lower case and has any non-three digit codes converted to <code>NA</code>. <code>catchname</code> codes are tidied following the suggested abbreviations, e.g. “Clutha River”, “Clutha r” and “Clutha river” all become Clutha R. Finally a new variable <code>form</code> is added which defines each observation as from one of the following systems: <code>Creek, River, Tributary, Stream, Lake, Lagoon, Pond, Burn, Race, Dam, Estuary, Swamp, Drain, Canal, Tarn, Wetland, Reservoir, Brook, Spring, Gully</code> or <code>NA</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/nzffd_clean.html">nzffd_clean</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dat2</span><span class="op">)</span>
<span class="co">#&gt;   card m    y catchname   catch                locality time org map    east</span>
<span class="co">#&gt; 1  294 5 2000    Long B 075.000 Unnamed Stream Long Bay   NA arc r10 2664600</span>
<span class="co">#&gt; 2  294 5 2000    Long B 075.000 Unnamed Stream Long Bay   NA arc r10 2664600</span>
<span class="co">#&gt; 3  294 5 2000    Long B 075.000 Unnamed Stream Long Bay   NA arc r10 2664600</span>
<span class="co">#&gt; 4  295 5 2000    Long B 075.000 Unnamed Stream Long Bay   NA arc r10 2664600</span>
<span class="co">#&gt; 5  295 5 2000    Long B 075.000 Unnamed Stream Long Bay   NA arc r10 2664600</span>
<span class="co">#&gt; 6  295 5 2000    Long B 075.000 Unnamed Stream Long Bay   NA arc r10 2664600</span>
<span class="co">#&gt;     north altitude penet fishmeth effort pass spcode abund number minl maxl</span>
<span class="co">#&gt; 1 6499800       30     3      gmt      6   NA galfas  &lt;NA&gt;      2   95  110</span>
<span class="co">#&gt; 2 6499800       30     3      gmt      6   NA gobhut  &lt;NA&gt;      2   80   85</span>
<span class="co">#&gt; 3 6499800       30     3      gmt      6   NA parane  &lt;NA&gt;      1   40   NA</span>
<span class="co">#&gt; 4 6499800       30     3      fyn      3   NA gobgob  &lt;NA&gt;      1  150   NA</span>
<span class="co">#&gt; 5 6499800       30     3      fyn      3   NA galfas  &lt;NA&gt;      3  130  135</span>
<span class="co">#&gt; 6 6499800       30     3      fyn      3   NA parane  &lt;NA&gt;      2   70   75</span>
<span class="co">#&gt;   nzreach   form</span>
<span class="co">#&gt; 1 2004154 Stream</span>
<span class="co">#&gt; 2 2004154 Stream</span>
<span class="co">#&gt; 3 2004154 Stream</span>
<span class="co">#&gt; 4 2004154 Stream</span>
<span class="co">#&gt; 5 2004154 Stream</span>
<span class="co">#&gt; 6 2004154 Stream</span>

<span class="co"># quick check for changes in the number of different catchment names (a </span>
<span class="co"># reduction means, names have successfully been recoded)</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">catchname</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 888</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">dat2</span><span class="op">$</span><span class="va">catchname</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 791</span></code></pre></div>
<p>The above changes, while superficial make analysis that, for example relies on grouping, work as intended.</p>
</div>
<div id="filling-gaps" class="section level3">
<h3 class="hasAnchor">
<a href="#filling-gaps" class="anchor"></a>Filling gaps</h3>
<p>Some additional useful information can quickly be added to the dataset. the <code><a href="reference/nzffd_fill.html">nzffd_fill()</a></code> function adds columns giving the species’ common name (<code>common_name</code>), scientific name (genus + species, <code>sci_name</code>), <code>family</code>, <code>genus</code>, <code>species</code>, threat classification status (<code>threat_class</code>) and weather the species is native or introduced (<code>native</code>).</p>
<p>Additionally, both the <code>map</code> and <code>altitude</code> variables have some <code>NA</code> values, here we can fill most of them with <code><a href="reference/nzffd_fill.html">nzffd_fill()</a></code>. To fill <code>map</code> and <code>altitude</code> we run the observation coordinates (NZMG) against a raster projection of the (<a href="https://koordinates.com/layer/413-nzms-260-map-series-index/">NZMS260 MapTiles</a>) and an 8m digital elevation model (<a href="https://data.linz.govt.nz/layer/51768-nz-8m-digital-elevation-model-2012/">DEM</a>) of NZ. Note the ‘altitude’ values are not exact so we suggest they are used in an exploratory manner only.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># check number of NA's in input variables map and altitude</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">dat2</span><span class="op">$</span><span class="va">map</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 908</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">dat2</span><span class="op">$</span><span class="va">altitude</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 592</span>
<span class="va">dat3</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/nzffd_fill.html">nzffd_fill</a></span><span class="op">(</span><span class="va">dat2</span>, alt <span class="op">=</span> <span class="cn">TRUE</span>, maps <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># check number of NA's in output variables map and altitude, NA's have been dealt with</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">dat3</span><span class="op">$</span><span class="va">maps</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 0</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">dat3</span><span class="op">$</span><span class="va">altitude</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 0</span>

<span class="co"># check new columns have been added</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dat3</span><span class="op">)</span>
<span class="co">#&gt;   spcode   card  m    y    catchname   catch                locality time  org</span>
<span class="co">#&gt; 1 aldfor  30488  3 2009       Avon R 666.000          Bexley Wetland   NA docc</span>
<span class="co">#&gt; 2 aldfor 111010 11 2003  Whanganui R 333.000         Whanganui River   NA  uow</span>
<span class="co">#&gt; 3 aldfor  30382  5 2009 Ruamahanga R 292.000              Lake Onoke   NA wnrc</span>
<span class="co">#&gt; 4 aldfor   7689  9 2001     Wairoa R 085.000            Wairoa River   NA niwa</span>
<span class="co">#&gt; 5 aldfor  21454  2 2002       Long B 075.000 Unnamed Stream Long Bay   NA nscc</span>
<span class="co">#&gt; 6 aldfor 105767  4 2005    Waimapu S 144.000          Waimapu Stream   NA  uow</span>
<span class="co">#&gt;   map    east   north altitude penet fishmeth effort pass abund number minl</span>
<span class="co">#&gt; 1 m35 2487482 5742964        5     1      ntc     32   NA  &lt;NA&gt;     36   95</span>
<span class="co">#&gt; 2 R10 2687692 6143373        9    11      efb    324    1  &lt;NA&gt;      1   NA</span>
<span class="co">#&gt; 3 r28 2686241 5978218        5     7      sen     NA   NA     a     NA   NA</span>
<span class="co">#&gt; 4 s11 2692300 6465800        5     7      ntc      7   NA     a     15  275</span>
<span class="co">#&gt; 5 r10 2665859 6500387       10     1      han     NA   NA  &lt;NA&gt;      6   NA</span>
<span class="co">#&gt; 6 u14 2787148 6379884       10     2      efb   1522   NA  &lt;NA&gt;      1   NA</span>
<span class="co">#&gt;   maxl  nzreach    form      common_name             sci_name    family</span>
<span class="co">#&gt; 1  271 13045924 Wetland Yelloweye mullet Aldrichetta forsteri Mugilidae</span>
<span class="co">#&gt; 2   NA  7029252   River Yelloweye mullet Aldrichetta forsteri Mugilidae</span>
<span class="co">#&gt; 3   NA  9016280    Lake Yelloweye mullet Aldrichetta forsteri Mugilidae</span>
<span class="co">#&gt; 4  345  2007061   River Yelloweye mullet Aldrichetta forsteri Mugilidae</span>
<span class="co">#&gt; 5  150  2004122  Stream Yelloweye mullet Aldrichetta forsteri Mugilidae</span>
<span class="co">#&gt; 6   NA  4001685  Stream Yelloweye mullet Aldrichetta forsteri Mugilidae</span>
<span class="co">#&gt;         genus  species   threat_class native</span>
<span class="co">#&gt; 1 Aldrichetta forsteri not threatened native</span>
<span class="co">#&gt; 2 Aldrichetta forsteri not threatened native</span>
<span class="co">#&gt; 3 Aldrichetta forsteri not threatened native</span>
<span class="co">#&gt; 4 Aldrichetta forsteri not threatened native</span>
<span class="co">#&gt; 5 Aldrichetta forsteri not threatened native</span>
<span class="co">#&gt; 6 Aldrichetta forsteri not threatened native</span></code></pre></div>
</div>
<div id="adding-river-environment-classification-data" class="section level3">
<h3 class="hasAnchor">
<a href="#adding-river-environment-classification-data" class="anchor"></a>Adding River Environment classification data</h3>
<p>We can also add associated network topology and environmental information from the River Environment Classification database (<a href="https://data.mfe.govt.nz/layer/51845-river-environment-classification-new-zealand-2010-deprecated/">REC</a>) using <code><a href="reference/nzffd_add.html">nzffd_add()</a></code>. This function takes the <code>nzreach</code> variable and matches it again the corresponding <code>NZREACH</code> variable in the REC database and imports all the REC data. Note this will add 24 new columns to your dataframe, with the original REC column names, we suggest renaming the REC columns as they are a bit fiendish as is.</p>
<p>This function requires an internet connection to query the REC database.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># check number of columns before REC data has been added</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">dat3</span><span class="op">)</span>
<span class="co">#&gt; [1] 58768    30</span>

<span class="co"># add REC data</span>
<span class="va">dat4</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/nzffd_add.html">nzffd_add</a></span><span class="op">(</span><span class="va">dat3</span><span class="op">)</span>

<span class="co"># check number of columns after REC data has been added</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">dat4</span><span class="op">)</span>
<span class="co">#&gt; [1] 58768    54</span></code></pre></div>
<p>You should now have a cleaned up dataframe of NZFFD records available to you, optionally along with some missing data and associated REC data.</p>
</div>
<div id="mapping-observations" class="section level3">
<h3 class="hasAnchor">
<a href="#mapping-observations" class="anchor"></a>Mapping observations</h3>
<p>There is a simple features map of New Zealand included in the package, this can be used to quickly check species distributions and the like.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ggplot2 for nice figures</span>
<span class="co"># sf library for setting map crs</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span> 

<span class="co"># get map of NZ and remove Chatham Islands</span>
<span class="va">nz</span> <span class="op">&lt;-</span> <span class="fu">nzffdr</span><span class="fu">::</span><span class="va"><a href="reference/nzffd_nzmap.html">nzffd_nzmap</a></span>
<span class="va">nz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">nz</span>, <span class="va">name</span> <span class="op">!=</span> <span class="st">"Chatham Island"</span><span class="op">)</span>

<span class="co"># use built-in subset of NZFFD data </span>
<span class="va">eels</span> <span class="op">&lt;-</span> <span class="fu">nzffdr</span><span class="fu">::</span><span class="va"><a href="reference/nzffd_data.html">nzffd_data</a></span>

<span class="co"># add scientific and common names for species</span>
<span class="va">eels</span> <span class="op">&lt;-</span> <span class="fu">nzffdr</span><span class="fu">::</span><span class="fu"><a href="reference/nzffd_fill.html">nzffd_fill</a></span><span class="op">(</span><span class="va">eels</span><span class="op">)</span>

<span class="co"># filter just eels species </span>
<span class="va">eels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">eels</span>, <span class="va">genus</span> <span class="op">==</span> <span class="st">"Anguilla"</span><span class="op">)</span>

<span class="co"># create a basic map, with points coloured by species common names</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">nz</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">eels</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">east</span>, y <span class="op">=</span> <span class="va">north</span>, colour <span class="op">=</span> <span class="va">common_name</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2e6</span>, <span class="fl">25e5</span>, <span class="fl">3e6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">54e5</span>, <span class="fl">61e5</span>, <span class="fl">68e5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">coord_sf</a></span><span class="op">(</span>datum <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="fl">27200</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-7-1.png"><!-- --></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Finnbar Lee <br><small class="roles"> Author, maintainer </small>  </li>
<li>Nick xx <br><small class="roles"> Author </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Finnbar Lee, Nick xx.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
